{"remainingRequest":"D:\\Code\\project\\vue-shp\\node_modules\\babel-loader\\lib\\index.js!D:\\Code\\project\\vue-shp\\src\\router\\index.js","dependencies":[{"path":"D:\\Code\\project\\vue-shp\\src\\router\\index.js","mtime":1662970376328},{"path":"D:\\Code\\project\\vue-shp\\babel.config.js","mtime":1642509932178},{"path":"D:\\Code\\project\\vue-shp\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1642509914891},{"path":"D:\\Code\\project\\vue-shp\\node_modules\\babel-loader\\lib\\index.js","mtime":1642509917213}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkQ6XFxDb2RlXFxwcm9qZWN0XFx2dWUtc2hwXFxub2RlX21vZHVsZXNcXEBiYWJlbFxccnVudGltZVxcaGVscGVyc1xcZXNtXFxhc3luY1RvR2VuZXJhdG9yLmpzIjsKaW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5yZXBsYWNlLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZS5qcyI7Ci8vIOmFjee9rui3r+eUsQppbXBvcnQgVnVlIGZyb20gInZ1ZSI7CmltcG9ydCBWdWVSb3V0ZXIgZnJvbSAidnVlLXJvdXRlciI7CmltcG9ydCByb3V0ZXMgZnJvbSAnLi9yb3V0ZXMuanMnOwppbXBvcnQgc3RvcmUgZnJvbSAnLi4vc3RvcmUnOyAvLyDkvb/nlKjmj5Lku7YKClZ1ZS51c2UoVnVlUm91dGVyKTsgLy8g5YWI5oqKVnVlUm91dGVy5Y6f5Z6L5a+56LGh55qEcHVzaHxyZXBsYWNl5L+d5a2Y5LiA5Lu9Cgp2YXIgb3JpZ2luUHVzaCA9IFZ1ZVJvdXRlci5wcm90b3R5cGUucHVzaDsKdmFyIG9yaWdpblJlcGxhY2UgPSBWdWVSb3V0ZXIucHJvdG90eXBlLnJlcGxhY2U7IC8vIOmHjeaWsHB1c2h8cmVwbGFjZeaWueazlQoKVnVlUm91dGVyLnByb3RvdHlwZS5wdXNoID0gZnVuY3Rpb24gKGxvY2F0aW9uLCByZXNvbHZlLCByZWplY3QpIHsKICBpZiAocmVzb2x2ZSAmJiByZWplY3QpIHsKICAgIG9yaWdpblB1c2guY2FsbCh0aGlzLCBsb2NhdGlvbiwgcmVzb2x2ZSwgcmVqZWN0KTsKICB9IGVsc2UgewogICAgb3JpZ2luUHVzaC5jYWxsKHRoaXMsIGxvY2F0aW9uLCBmdW5jdGlvbiAoKSB7fSwgZnVuY3Rpb24gKCkge30pOwogIH0KfTsKClZ1ZVJvdXRlci5wcm90b3R5cGUucmVwbGFjZSA9IGZ1bmN0aW9uIChsb2NhdGlvbiwgcmVzb2x2ZSwgcmVqZWN0KSB7CiAgaWYgKHJlc29sdmUgJiYgdGhpcy5yZXBsYWNlKSB7CiAgICAvLyBjYWxsfGFwcGx555u45ZCM54K577ya6YO95Y+v5Lul6LCD55So5Ye95pWw5LiA5qyh77yM5Lmf5Y+v5Lul56+h5pS55Ye95pWw5LiK5LiL5paH5LiA5qyhCiAgICAvLyBjYWxsfGFwcGx55Yy65Yir77yaY2FsbOS8oOmAkuWkmuS4quWPguaVsOeUqOmAl+WPt+malOW8gO+8jGFwcGx55Lyg6YCS5Y+C5pWw5L2/55So5pWw57uECiAgICBvcmlnaW5SZXBsYWNlLmNhbGwodGhpcywgbG9jYXRpb24sIHJlc29sdmUsIHJlamVjdCk7CiAgfSBlbHNlIHsKICAgIG9yaWdpblJlcGxhY2UuY2FsbCh0aGlzLCBsb2NhdGlvbiwgZnVuY3Rpb24gKCkge30sIGZ1bmN0aW9uICgpIHt9KTsKICB9Cn07Cgp2YXIgcm91dGVyID0gbmV3IFZ1ZVJvdXRlcih7CiAgcm91dGVzOiByb3V0ZXMsCiAgLy8g5rua5Yqo6KGM5Li6CiAgc2Nyb2xsQmVoYXZpb3I6IGZ1bmN0aW9uIHNjcm9sbEJlaGF2aW9yKHRvLCBmcm9tLCBzYXZlZFBvc2l0aW9uKSB7CiAgICAvLyB5OjDku6Pooajot6/nlLHot7PovazlkI7mu5rliqjmnaHlnKjmnIDkuIrmlrkKICAgIHJldHVybiB7CiAgICAgIHk6IDAKICAgIH07CiAgfQp9KTsgLy8g5YWo5bGA5a6I5Y2r77ya5YmN572u5a6I5Y2rCgpyb3V0ZXIuYmVmb3JlRWFjaCggLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICB2YXIgX3JlZiA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSh0bywgZnJvbSwgbmV4dCkgewogICAgdmFyIHRva2VuLCBuYW1lOwogICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAvLyB0bzrlj6/ku6Xojrflj5bliLDkvaDmg7Pot7PliLDnmoTot6/nlLHnmoTkv6Hmga8KICAgICAgICAgICAgLy8gZnJvbe+8muWPr+S7peiOt+WPluWIsOS9oOS7juWTquS4qui3r+eUseadpeeahOS/oeaBrwogICAgICAgICAgICAvLyBuZXh077ya5pS+6KGM5Ye95pWwIOWFqOmDqOaUvuihjO+8mm5leHQoKSDmlL7ooYzmjIflrprot6/nlLHvvJpuZXh0KCcvbG9naW4nKSAgbmV4dChmYWxzZSkKICAgICAgICAgICAgLy8gbmV4dCgpOwogICAgICAgICAgICAvLyDnlKjmiLfnmbvlvZXkuobmiY3kvJrmnIl0b2tlbgogICAgICAgICAgICB0b2tlbiA9IHN0b3JlLnN0YXRlLnVzZXIudG9rZW47CiAgICAgICAgICAgIG5hbWUgPSBzdG9yZS5zdGF0ZS51c2VyLnVzZXJJbmZvLm5hbWU7CgogICAgICAgICAgICBpZiAoIXRva2VuKSB7CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDI0OwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoISh0by5wYXRoID09ICcvbG9naW4nKSkgewogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA3OwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICBuZXh0KCcvaG9tZScpOwogICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjI7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgaWYgKCFuYW1lKSB7CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDExOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyDlpoLmnpznmbvlvZXkuoYKICAgICAgICAgICAgbmV4dCgpOwogICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjI7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgMTE6CiAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAxMTsKICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDE0OwogICAgICAgICAgICByZXR1cm4gc3RvcmUuZGlzcGF0Y2goJ2dldFVzZXJJbmZvJyk7CgogICAgICAgICAgY2FzZSAxNDoKICAgICAgICAgICAgbmV4dCgpOwogICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjI7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgMTc6CiAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAxNzsKICAgICAgICAgICAgX2NvbnRleHQudDAgPSBfY29udGV4dFsiY2F0Y2giXSgxMSk7CiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyMTsKICAgICAgICAgICAgcmV0dXJuIHN0b3JlLmRpc3BhdGNoKCd1c2VyTG9nT3V0Jyk7CgogICAgICAgICAgY2FzZSAyMToKICAgICAgICAgICAgbmV4dCgnL2xvZ2luJyk7CgogICAgICAgICAgY2FzZSAyMjoKICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDI1OwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDI0OgogICAgICAgICAgICAvLyDmnKrnmbvlvZUKICAgICAgICAgICAgbmV4dCgpOwoKICAgICAgICAgIGNhc2UgMjU6CiAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgIH0KICAgICAgfQogICAgfSwgX2NhbGxlZSwgbnVsbCwgW1sxMSwgMTddXSk7CiAgfSkpOwoKICByZXR1cm4gZnVuY3Rpb24gKF94LCBfeDIsIF94MykgewogICAgcmV0dXJuIF9yZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICB9Owp9KCkpOwpleHBvcnQgZGVmYXVsdCByb3V0ZXI7"},{"version":3,"sources":["D:/Code/project/vue-shp/src/router/index.js"],"names":["Vue","VueRouter","routes","store","use","originPush","prototype","push","originReplace","replace","location","resolve","reject","call","router","scrollBehavior","to","from","savedPosition","y","beforeEach","next","token","state","user","name","userInfo","path","dispatch"],"mappings":";;;;;AAAA;AACA,OAAOA,GAAP,MAAgB,KAAhB;AACA,OAAOC,SAAP,MAAsB,YAAtB;AACA,OAAOC,MAAP,MAAmB,aAAnB;AACA,OAAOC,KAAP,MAAkB,UAAlB,C,CACA;;AACAH,GAAG,CAACI,GAAJ,CAAQH,SAAR,E,CACA;;AACA,IAAII,UAAU,GAAGJ,SAAS,CAACK,SAAV,CAAoBC,IAArC;AACA,IAAIC,aAAa,GAAGP,SAAS,CAACK,SAAV,CAAoBG,OAAxC,C,CACA;;AACAR,SAAS,CAACK,SAAV,CAAoBC,IAApB,GAA2B,UAAUG,QAAV,EAAoBC,OAApB,EAA6BC,MAA7B,EAAqC;AAC5D,MAAID,OAAO,IAAIC,MAAf,EAAuB;AACnBP,IAAAA,UAAU,CAACQ,IAAX,CAAgB,IAAhB,EAAsBH,QAAtB,EAAgCC,OAAhC,EAAyCC,MAAzC;AACH,GAFD,MAEO;AACHP,IAAAA,UAAU,CAACQ,IAAX,CAAgB,IAAhB,EAAsBH,QAAtB,EAAgC,YAAM,CAAG,CAAzC,EAA2C,YAAM,CAAG,CAApD;AACH;AACJ,CAND;;AAOAT,SAAS,CAACK,SAAV,CAAoBG,OAApB,GAA8B,UAAUC,QAAV,EAAoBC,OAApB,EAA6BC,MAA7B,EAAqC;AAC/D,MAAID,OAAO,IAAI,KAAKF,OAApB,EAA6B;AACzB;AACA;AACAD,IAAAA,aAAa,CAACK,IAAd,CAAmB,IAAnB,EAAyBH,QAAzB,EAAmCC,OAAnC,EAA4CC,MAA5C;AACH,GAJD,MAIO;AACHJ,IAAAA,aAAa,CAACK,IAAd,CAAmB,IAAnB,EAAyBH,QAAzB,EAAmC,YAAM,CAAG,CAA5C,EAA8C,YAAM,CAAG,CAAvD;AACH;AACJ,CARD;;AASA,IAAII,MAAM,GAAG,IAAIb,SAAJ,CAAc;AACvBC,EAAAA,MAAM,EAANA,MADuB;AAEvB;AACAa,EAAAA,cAHuB,0BAGRC,EAHQ,EAGJC,IAHI,EAGEC,aAHF,EAGiB;AACpC;AACA,WAAO;AAAEC,MAAAA,CAAC,EAAE;AAAL,KAAP;AACH;AANsB,CAAd,CAAb,C,CASA;;AACAL,MAAM,CAACM,UAAP;AAAA,qEAAkB,iBAAOJ,EAAP,EAAWC,IAAX,EAAiBI,IAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AACd;AACA;AACA;AACA;AACA;AACIC,YAAAA,KANU,GAMFnB,KAAK,CAACoB,KAAN,CAAYC,IAAZ,CAAiBF,KANf;AAOVG,YAAAA,IAPU,GAOHtB,KAAK,CAACoB,KAAN,CAAYC,IAAZ,CAAiBE,QAAjB,CAA0BD,IAPvB;;AAAA,iBAQVH,KARU;AAAA;AAAA;AAAA;;AAAA,kBASNN,EAAE,CAACW,IAAH,IAAW,QATL;AAAA;AAAA;AAAA;;AAUNN,YAAAA,IAAI,CAAC,OAAD,CAAJ;AAVM;AAAA;;AAAA;AAAA,iBAYFI,IAZE;AAAA;AAAA;AAAA;;AAaF;AACAJ,YAAAA,IAAI;AAdF;AAAA;;AAAA;AAAA;AAAA;AAAA,mBAkBQlB,KAAK,CAACyB,QAAN,CAAe,aAAf,CAlBR;;AAAA;AAmBEP,YAAAA,IAAI;AAnBN;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA,mBAuBQlB,KAAK,CAACyB,QAAN,CAAe,YAAf,CAvBR;;AAAA;AAwBEP,YAAAA,IAAI,CAAC,QAAD,CAAJ;;AAxBF;AAAA;AAAA;;AAAA;AA6BV;AACAA,YAAAA,IAAI;;AA9BM;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAlB;;AAAA;AAAA;AAAA;AAAA;AAmCA,eAAeP,MAAf","sourcesContent":["// 配置路由\r\nimport Vue from \"vue\";\r\nimport VueRouter from \"vue-router\";\r\nimport routes from './routes.js'\r\nimport store from '../store'\r\n// 使用插件\r\nVue.use(VueRouter)\r\n// 先把VueRouter原型对象的push|replace保存一份\r\nlet originPush = VueRouter.prototype.push\r\nlet originReplace = VueRouter.prototype.replace\r\n// 重新push|replace方法\r\nVueRouter.prototype.push = function (location, resolve, reject) {\r\n    if (resolve && reject) {\r\n        originPush.call(this, location, resolve, reject)\r\n    } else {\r\n        originPush.call(this, location, () => { }, () => { })\r\n    }\r\n}\r\nVueRouter.prototype.replace = function (location, resolve, reject) {\r\n    if (resolve && this.replace) {\r\n        // call|apply相同点：都可以调用函数一次，也可以篡改函数上下文一次\r\n        // call|apply区别：call传递多个参数用逗号隔开，apply传递参数使用数组\r\n        originReplace.call(this, location, resolve, reject)\r\n    } else {\r\n        originReplace.call(this, location, () => { }, () => { })\r\n    }\r\n}\r\nlet router = new VueRouter({\r\n    routes,\r\n    // 滚动行为\r\n    scrollBehavior(to, from, savedPosition) {\r\n        // y:0代表路由跳转后滚动条在最上方\r\n        return { y: 0 }\r\n    },\r\n})\r\n\r\n// 全局守卫：前置守卫\r\nrouter.beforeEach(async (to, from, next) => {\r\n    // to:可以获取到你想跳到的路由的信息\r\n    // from：可以获取到你从哪个路由来的信息\r\n    // next：放行函数 全部放行：next() 放行指定路由：next('/login')  next(false)\r\n    // next();\r\n    // 用户登录了才会有token\r\n    let token = store.state.user.token\r\n    let name = store.state.user.userInfo.name\r\n    if (token) {\r\n        if (to.path == '/login') {\r\n            next('/home')\r\n        } else {\r\n            if (name) {\r\n                // 如果登录了\r\n                next()\r\n            } else {\r\n                // 如果没登录 派发action让仓库存储用户信息再跳转\r\n                try {\r\n                    await store.dispatch('getUserInfo')\r\n                    next()\r\n                } catch (error) {\r\n                    // token失效 获取不到用户信息\r\n                    // 清除token\r\n                    await store.dispatch('userLogOut')\r\n                    next('/login')\r\n                }\r\n            }\r\n        }\r\n    } else {\r\n        // 未登录\r\n        next()\r\n    }\r\n})\r\n\r\n\r\nexport default router"]}]}